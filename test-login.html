<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–¢–µ—Å—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏</title>
  <style>
    body {
      font-family: monospace;
      padding: 20px;
      background: #1a1a1a;
      color: #0f0;
    }
    .section {
      background: #000;
      border: 1px solid #0f0;
      padding: 15px;
      margin: 10px 0;
    }
    h2 { color: #0ff; }
    button {
      background: #0f0;
      color: #000;
      border: none;
      padding: 10px 20px;
      margin: 5px;
      cursor: pointer;
      font-weight: bold;
    }
    input {
      background: #222;
      color: #0f0;
      border: 1px solid #0f0;
      padding: 8px;
      margin: 5px;
    }
    pre {
      background: #111;
      padding: 10px;
      overflow-x: auto;
      border-left: 3px solid #0f0;
    }
  </style>
</head>
<body>
  <h1>üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ Call Analytics</h1>

  <div class="section">
    <h2>üìã –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤ localStorage</h2>
    <button onclick="showUsers()">–ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</button>
    <button onclick="clearAllData()">–û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ</button>
    <button onclick="resetDemo()">–°–±—Ä–æ—Å–∏—Ç—å –¥–µ–º–æ-–¥–∞–Ω–Ω—ã–µ</button>
    <pre id="usersOutput">–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –≤—ã—à–µ</pre>
  </div>

  <div class="section">
    <h2>üîê –¢–µ—Å—Ç –≤—Ö–æ–¥–∞</h2>
    <div>
      <input type="text" id="testUsername" placeholder="–õ–æ–≥–∏–Ω" value="ivanov">
      <input type="password" id="testPassword" placeholder="–ü–∞—Ä–æ–ª—å" value="111111">
      <button onclick="testLogin()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Ö–æ–¥</button>
    </div>
    <pre id="loginOutput">–†–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ—è–≤–∏—Ç—Å—è –∑–¥–µ—Å—å</pre>
  </div>

  <div class="section">
    <h2>üîë –ò–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å</h2>
    <div>
      <input type="text" id="changeUsername" placeholder="–õ–æ–≥–∏–Ω" value="ivanov">
      <input type="password" id="newPassword" placeholder="–ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å" value="111111">
      <button onclick="changePassword()">–ò–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å</button>
    </div>
    <pre id="changeOutput">–†–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ—è–≤–∏—Ç—Å—è –∑–¥–µ—Å—å</pre>
  </div>

  <div class="section">
    <h2>üîÑ –¢–µ–∫—É—â–∞—è —Å–µ—Å—Å–∏—è</h2>
    <button onclick="showSession()">–ü–æ–∫–∞–∑–∞—Ç—å —Å–µ—Å—Å–∏—é</button>
    <button onclick="clearSession()">–û—á–∏—Å—Ç–∏—Ç—å —Å–µ—Å—Å–∏—é</button>
    <pre id="sessionOutput">–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –≤—ã—à–µ</pre>
  </div>

  <div class="section">
    <button onclick="goToLogin()" style="background: #0ff;">‚û°Ô∏è –ü–µ—Ä–µ–π—Ç–∏ –∫ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –≤—Ö–æ–¥–∞</button>
  </div>

  <script>
    function showUsers() {
      const users = JSON.parse(localStorage.getItem('users') || '[]');
      document.getElementById('usersOutput').textContent = JSON.stringify(users, null, 2);
    }

    function testLogin() {
      const username = document.getElementById('testUsername').value;
      const password = document.getElementById('testPassword').value;
      
      const users = JSON.parse(localStorage.getItem('users') || '[]');
      const user = users.find(u => u.username === username && u.password === password);
      
      const output = document.getElementById('loginOutput');
      
      if (user) {
        output.textContent = '‚úÖ –£–°–ü–ï–•! –ù–∞–π–¥–µ–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:\n' + JSON.stringify(user, null, 2);
        output.style.color = '#0f0';
      } else {
        const userByName = users.find(u => u.username === username);
        if (userByName) {
          output.textContent = '‚ùå –û–®–ò–ë–ö–ê: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–π–¥–µ–Ω, –Ω–æ –ø–∞—Ä–æ–ª—å –Ω–µ–≤–µ—Ä–Ω—ã–π!\n\n' +
            '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤ –±–∞–∑–µ:\n' + JSON.stringify(userByName, null, 2) +
            '\n\n–í–≤–µ–¥–µ–Ω–Ω—ã–π –ø–∞—Ä–æ–ª—å: "' + password + '"\n' +
            '–°–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–π –ø–∞—Ä–æ–ª—å: "' + userByName.password + '"';
          output.style.color = '#f00';
        } else {
          output.textContent = '‚ùå –û–®–ò–ë–ö–ê: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å –ª–æ–≥–∏–Ω–æ–º "' + username + '" –Ω–µ –Ω–∞–π–¥–µ–Ω!\n\n' +
            '–î–æ—Å—Ç—É–ø–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏:\n' + users.map(u => u.username).join(', ');
          output.style.color = '#f00';
        }
      }
    }

    function changePassword() {
      const username = document.getElementById('changeUsername').value;
      const newPassword = document.getElementById('newPassword').value;
      
      const users = JSON.parse(localStorage.getItem('users') || '[]');
      const userIndex = users.findIndex(u => u.username === username);
      
      const output = document.getElementById('changeOutput');
      
      if (userIndex !== -1) {
        const oldPassword = users[userIndex].password;
        users[userIndex].password = newPassword;
        localStorage.setItem('users', JSON.stringify(users));
        
        output.textContent = '‚úÖ –ü–∞—Ä–æ–ª—å –∏–∑–º–µ–Ω–µ–Ω!\n\n' +
          '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: ' + username + '\n' +
          '–°—Ç–∞—Ä—ã–π –ø–∞—Ä–æ–ª—å: ' + oldPassword + '\n' +
          '–ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å: ' + newPassword;
        output.style.color = '#0f0';
        
        showUsers();
      } else {
        output.textContent = '‚ùå –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω: ' + username;
        output.style.color = '#f00';
      }
    }

    function showSession() {
      const currentUser = sessionStorage.getItem('currentUser');
      const rememberMe = localStorage.getItem('rememberMe');
      
      const output = document.getElementById('sessionOutput');
      output.textContent = 'SessionStorage:\n' + (currentUser || '–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö') + '\n\n' +
                          'RememberMe (localStorage):\n' + (rememberMe || '–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö');
    }

    function clearSession() {
      sessionStorage.clear();
      localStorage.removeItem('rememberMe');
      document.getElementById('sessionOutput').textContent = '‚úÖ –°–µ—Å—Å–∏—è –æ—á–∏—â–µ–Ω–∞';
      showSession();
    }

    function clearAllData() {
      if (confirm('–£–¥–∞–ª–∏—Ç—å –í–°–ï –¥–∞–Ω–Ω—ã–µ –∏–∑ localStorage?')) {
        localStorage.clear();
        sessionStorage.clear();
        alert('‚úÖ –í—Å–µ –¥–∞–Ω–Ω—ã–µ —É–¥–∞–ª–µ–Ω—ã! –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É.');
        location.reload();
      }
    }

    function resetDemo() {
      const demoUsers = [
        {
          id: 1,
          username: 'admin',
          password: 'admin123',
          email: 'admin@callanalytics.com',
          role: 'manager',
          status: 'active',
          managerId: null,
          createdAt: new Date().toISOString()
        },
        {
          id: 2,
          username: 'ivanov',
          password: 'ivanov123',
          email: 'ivanov@callanalytics.com',
          role: 'employee',
          status: 'active',
          managerId: 1,
          createdAt: new Date().toISOString()
        }
      ];
      
      localStorage.setItem('users', JSON.stringify(demoUsers));
      alert('‚úÖ –î–µ–º–æ-–¥–∞–Ω–Ω—ã–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã!\n–õ–æ–≥–∏–Ω—ã: admin/admin123, ivanov/ivanov123');
      showUsers();
    }

    function goToLogin() {
      window.location.href = 'admin-login.html';
    }

    // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–∫–∞–∑–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
    window.addEventListener('DOMContentLoaded', function() {
      showUsers();
      showSession();
    });
  </script>
</body>
</html>
